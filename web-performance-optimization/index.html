<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"/><title>Web性能优化 | Web performance optimization</title><link href="/assets/css/reveal.min.css" rel="stylesheet"><link href="/assets/css/theme/black.min.css" id="theme" rel="stylesheet"><link href="/assets/css/slide.css" rel="stylesheet"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Web Performance Optimization"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="mobile-web-app-capable" content="yes"><meta name="full-screen" content="yes"><meta name="browsermode" content="application"><meta name="screen-orientation" content="landscape"><meta name="x5-orientation" content="landscape"><meta name="x5-page-mode" content="app"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="HandheldFriendly" content="true"><meta content="telephone=no" name="format-detection"><meta content="email=no" name="format-detection"><link rel="canonical" href="https://slides.newfuture.cc/web-performance-optimization/"></head><body><main class="reveal"><div class="slides"><section><h1>Web性能优化</h1><div class="qrcode"> https://api.qrserver.com/v1/create-qr-code/?size=100x100&format=svg&data=https://slides.newfuture.cc/web-performance-optimization/ <g>https://api.qrserver.com/v1/create-qr-code/?size=100x100&format=svg&data=https://slides.newfuture.cc/web-performance-optimization/</div><p>Web Performance Optimization</p><div> <small><a href="/web-performance-optimization/">slides.newfuture.cc/web-performance-optimization/</a></small></div><small><a class="author" href="">@NewFuture</a></small></section><section><h2 id="目录">目录</h2><ul><li>web 处理基本流程</li><li>后端</li><li>前端</li><li>实践指导</li></ul></section><section><section><h2 id="time-line">time line</h2><p><img src="/assets/img/web-performance-optimization/web_timeline.png" alt="" /></p></section><section><h2 id="基本流程">基本流程</h2><p><code class="highlighter-rouge">后端输出</code> ==&gt; <code class="highlighter-rouge">加载前端资源</code> ==&gt; <code class="highlighter-rouge">渲染交互</code></p></section></section><section><section><h2 id="后端渲染时间消耗">后端渲染时间消耗</h2><table><thead><tr><th>操作</th><th style="text-align: left">基本时间消耗</th><th style="text-align: center">备注说明</th></tr></thead><tbody><tr><td>解析和反向代理</td><td style="text-align: left">ms级</td><td style="text-align: center">复杂匹配修改可能变慢</td></tr><tr><td>URL路由</td><td style="text-align: left">ms级</td><td style="text-align: center">复杂的hook可能变慢</td></tr><tr><td>远程API</td><td style="text-align: left">内网0.5s级/公网s级</td><td style="text-align: center">一般不超过60s</td></tr><tr><td>数据库操作</td><td style="text-align: left">100ms~1s</td><td style="text-align: center">写比读慢</td></tr><tr><td>文件操作</td><td style="text-align: left">10ms级</td><td style="text-align: center">写比读慢</td></tr><tr><td>模板解析渲染</td><td style="text-align: left">10ms</td><td style="text-align: center">嵌套或者ASP控件会慢</td></tr></tbody></table></section><section><h3 id="优化原则">优化原则</h3><ol><li>尽量加快首页输出时间</li><li>优先使用内存缓存</li><li>尽量减少远程调用<ul><li>缓存</li><li>避免再循环中调用</li></ul></li><li>数据库操作避免大量写入<ul><li>减少和合并写操作</li><li>避免循环中操作数据库</li></ul></li></ol></section></section><section><section><h2 id="前端消耗">前端消耗</h2><ul><li>文件下载 (后端和网络影响)</li><li>解析执行</li><li>页面渲染</li><li>事件捕获</li></ul></section><section><h3 id="资源下载">资源下载</h3><table><thead><tr><th>操作</th><th style="text-align: left">基本时间消耗</th><th style="text-align: center">备注说明</th></tr></thead><tbody><tr><td>小静态资源下载</td><td style="text-align: left">s级</td><td style="text-align: center">与网速和服务器相关</td></tr><tr><td>大静态资源下载</td><td style="text-align: left">1s~10级</td><td style="text-align: center">与网络状况相关</td></tr><tr><td>缓存</td><td style="text-align: left">ms级</td><td style="text-align: center"> </td></tr></tbody></table></section><section><h3 id="解析执行">解析执行</h3><table><thead><tr><th>操作</th><th style="text-align: left">基本时间消耗</th><th style="text-align: center">备注说明</th></tr></thead><tbody><tr><td>HTML解析</td><td style="text-align: left">10ms级</td><td style="text-align: center">复杂html可能更长</td></tr><tr><td>JS框架执行</td><td style="text-align: left">100ms级</td><td style="text-align: center"> </td></tr><tr><td>CSS解析</td><td style="text-align: left">100ms级</td><td style="text-align: center">可能会二次加载</td></tr></tbody></table></section><section><h3 id="优化原则-1">优化原则</h3><ul><li>精简首次渲染</li><li>压缩资源</li><li>减少合并请求,异步加载非首要内容</li><li>简化结构和缩小体积</li></ul></section></section><section><section><h2 id="提高web性能指南">提高WEB性能指南</h2><ul><li>后端开发</li><li>前端开发</li><li>服务器和CDN</li></ul><p>三个方面: 前两个coding和设计时注意,后一个通过升级配置实现</p></section><section><h3 id="优化后端编码">优化后端编码</h3><ol><li>尽量使用 <strong>缓存</strong> (内存和redis) 和允许必要的客户端缓存</li><li><strong>分离静态资</strong>源到CDN</li><li>减少和优化远程API调用,首页尽量避免调用</li><li>减少和优化数据库操作,首页避免数据库写入和多次操作</li><li>尽量<strong>减少重定向</strong>,避免多次重定向</li><li>尽量减少cookie的使用</li></ol></section><section><h3 id="优化前端">优化前端</h3><ol><li>文件 <strong>压缩</strong> 和 <strong>打包</strong> (&lt;200K最佳,不要超过500K)</li><li>JS尽量 <strong>减少库依赖</strong> 和 分离css</li><li>CSS 避免使用 <code class="highlighter-rouge">import</code> 和 <code class="highlighter-rouge">计算表达式</code></li><li>css在head,js在<code class="highlighter-rouge">&lt;/body&gt;</code>前引入,考虑异步或延迟</li><li>HTML和CSS 尽量<strong>减少DOM嵌套层次</strong>,规范语法</li><li>避免使用 <code class="highlighter-rouge">iframe</code> 和 <code class="highlighter-rouge">cookie</code></li></ol></section><section><h3 id="优化服务器和cdn配置">优化服务器和CDN配置</h3><ol><li>开启<code class="highlighter-rouge">GZip</code> 压缩(文本效率高)</li><li>最优化设置 <strong>缓存头</strong> <code class="highlighter-rouge">Cache-Control</code></li><li>CDN 开启 <code class="highlighter-rouge">HTTP2</code> (多图效率高)</li><li>设置 <code class="highlighter-rouge">ETag</code> 和 <code class="highlighter-rouge">Expires</code> 头</li><li>CDN 使用单独域名,无cookie</li><li>配置优化HTTPS (算法选择，简化握手)</li></ol></section></section><section><h2 id="性能分析工具">性能分析工具</h2><ul><li>网页性能分析<a href="https://developers.google.com/speed/pagespeed/">PageSpeed</a></li><li>网站分析<a href="http://yslow.org/">YSlow</a></li><li>Webpack JS依赖和体积分析<a href="http://alexkuz.github.io/webpack-chart/">webpack-chart</a>或<a href="http://webpack.github.io/analyse/">webpack analyse</a></li><li>Chrome 调试工具: <a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/">Performance</a> 和 Audits</li></ul></section><section class="end"><h3>THE END</h3><h2><strong>THANKS</strong></h2><h4><small>Web性能优化</small></h4><p> <small>CODE: <a href="https://github.com/NewFuture/slides/blob/gh-pages/_slides/2017-09-12-web-performance-optimization.md">https://github.com/NewFuture/slides</a></small><br/> <small>LINK: <a href="/web-performance-optimization/">https://slides.newfuture.cc/web-performance-optimization/</a></small></p><footer class="links"> <a class="link" href="https://slides.newfuture.cc">Home(主页)</a> <a class="link" href="#/">Replay(重放)</a> <a class="link" target="_blank" href="https://github.com/NewFuture/slides/edit/gh-pages/_slides/2017-09-12-web-performance-optimization.md">Edit(修改)</a> <a class="link desktop-chrome" href="?print-pdf">Print(打印)</a></footer></section></div></main><script src="/assets/lib/js/head.min.js"></script><script src="/assets/js/reveal.min.js"></script><script>Reveal.addEventListener( 'ready', function(){ head.test(head.desktop&&/print-pdf/gi.test(location.search), [ '/assets/css/theme/white.min.css', '/assets/css/print/pdf.min.css' ], [], function(){window.print(); setTimeout("history.go(-1)",1500)} ) } ); Reveal.initialize({ height: 720, width: 1280, loop: false, controls: true, progress: true, history: true, center: true, touch: true, slideNumber: 'c/t', transition: 'slide', dependencies: [ { src: '/assets/lib/js/classList.js', condition: function() { return !document.body.classList; } }, { src: '/assets/js/notes.plugin.min.js', condition: function() { return head.desktop} } ] });</script></body></html>